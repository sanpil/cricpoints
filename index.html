<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèè 16-Over Cricket Match Points Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
            color: #fff;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            border: 1px solid #444;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #444;
        }

        .header h1 {
            color: #4CAF50;
            font-size: 1.8em;
            margin-bottom: 10px;
        }

        .header p {
            color: #ccc;
            margin: 5px 0;
        }

        .step-section {
            background: rgba(255, 255, 255, 0.05);
            border-left: 4px solid #4CAF50;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .step-title {
            color: #4CAF50;
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .input-group {
            margin: 15px 0;
        }

        .input-group label {
            color: #fff;
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .input-group input, .input-group select {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #555;
            border-radius: 5px;
            padding: 10px;
            color: #fff;
            width: 100%;
            font-size: 1em;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #4CAF50;
            background: rgba(255, 255, 255, 0.15);
        }

        .radio-group {
            display: flex;
            gap: 20px;
            margin: 10px 0;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #fff;
        }

        .radio-option input[type="radio"] {
            width: auto;
        }

        .button {
            background: #4CAF50;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            margin: 10px 5px;
            transition: background 0.3s;
        }

        .button:hover {
            background: #45a049;
        }

        .button:disabled {
            background: #666;
            cursor: not-allowed;
        }

        .results {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid #444;
            border-radius: 10px;
            padding: 25px;
            margin-top: 30px;
            display: none;
        }

        .results-header {
            text-align: center;
            color: #4CAF50;
            font-size: 1.5em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #444;
        }

        .match-summary {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .team-result {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .team-result.winner {
            border-left: 4px solid #4CAF50;
        }

        .team-result.loser {
            border-left: 4px solid #FF9800;
        }

        .team-result.tie {
            border-left: 4px solid #2196F3;
        }

        .points-display {
            font-size: 2.5em;
            font-weight: bold;
            margin: 10px 0;
        }

        .breakdown {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .breakdown h3 {
            color: #4CAF50;
            margin-bottom: 15px;
        }

        .breakdown-line {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            padding: 5px 0;
        }

        .breakdown-line.total {
            border-top: 1px solid #444;
            margin-top: 15px;
            padding-top: 15px;
            font-weight: bold;
        }

        .error {
            background: #f44336;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            display: none;
        }

        .special-case {
            background: rgba(255, 193, 7, 0.2);
            border-left: 4px solid #FFC107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        @media (max-width: 768px) {
            .match-summary {
                grid-template-columns: 1fr;
            }
            
            .radio-group {
                flex-direction: column;
                gap: 10px;
            }
        }

        .hidden {
            display: none;
        }

        .console-output {
            background: #000;
            color: #0f0;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            margin: 10px 0;
            white-space: pre-wrap;
            border: 1px solid #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèè 16-Over Cricket Match Points Calculator</h1>
            <p>Calculates points for teams based on the detailed scoring system:</p>
            <p>- 30 total points per game</p>
            <p>- Winning team: 20 + leftover bonus points</p>
            <p>- Losing team: max 10 bonus points (batting + bowling)</p>
            <p>- Tie: 15 points each, no bonus</p>
            <p>- Special case: All out with &lt;8 players gives max bowling points</p>
            <p><strong>‚úÖ FIXED: Corrected batting points logic!</strong></p>
        </div>

        <div id="step1" class="step-section">
            <div class="step-title">üìù Enter Match Details:</div>
            
            <div class="input-group">
                <label for="team1-name">Team 1 name:</label>
                <input type="text" id="team1-name" placeholder="Team 1" value="Team 1">
            </div>
            
            <div class="input-group">
                <label for="team2-name">Team 2 name:</label>
                <input type="text" id="team2-name" placeholder="Team 2" value="Team 2">
            </div>
            
            <button class="button" onclick="proceedToMatchResult()">Next ‚û°Ô∏è</button>
        </div>

        <div id="step2" class="step-section hidden">
            <div class="step-title">Match Result Options:</div>
            
            <div class="radio-group">
                <div class="radio-option">
                    <input type="radio" id="team1-wins" name="match-result" value="team1">
                    <label for="team1-wins" id="team1-wins-label">Team 1 won</label>
                </div>
                <div class="radio-option">
                    <input type="radio" id="team2-wins" name="match-result" value="team2">
                    <label for="team2-wins" id="team2-wins-label">Team 2 won</label>
                </div>
                <div class="radio-option">
                    <input type="radio" id="tie" name="match-result" value="tie">
                    <label for="tie">Tie</label>
                </div>
            </div>
            
            <button class="button" onclick="goBack('step1')">‚¨ÖÔ∏è Back</button>
            <button class="button" onclick="proceedToScores()">Next ‚û°Ô∏è</button>
        </div>

        <div id="step3" class="step-section hidden">
            <div class="step-title" id="winner-announcement">üìä Team won! Enter detailed scores:</div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div class="input-group">
                    <label id="winner-runs-label">Winner total runs:</label>
                    <input type="number" id="winner-runs" min="0" required>
                </div>
                <div class="input-group">
                    <label id="winner-overs-label">Winner overs faced:</label>
                    <input type="number" id="winner-overs" min="0" max="16" step="0.1" 
                           placeholder="e.g., 15.4 (15 overs, 4 balls)" required>
                </div>
                <div class="input-group">
                    <label id="loser-runs-label">Loser total runs:</label>
                    <input type="number" id="loser-runs" min="0" required>
                </div>
                <div class="input-group">
                    <label id="loser-overs-label">Loser overs faced:</label>
                    <input type="number" id="loser-overs" min="0" max="16" step="0.1" 
                           placeholder="e.g., 15.4 (15 overs, 4 balls)" required>
                </div>
            </div>
            
            <div class="input-group">
                <label id="wickets-label">Wickets taken by loser:</label>
                <input type="number" id="wickets" min="0" max="10" required>
            </div>
            
            <button class="button" onclick="goBack('step2')">‚¨ÖÔ∏è Back</button>
            <button class="button" onclick="proceedToBattingOrder()">Next ‚û°Ô∏è</button>
        </div>

        <div id="step4" class="step-section hidden">
            <div class="step-title">Batting Order:</div>
            
            <div class="radio-group">
                <div class="radio-option">
                    <input type="radio" id="team1-batted-first" name="batting-order" value="team1">
                    <label for="team1-batted-first" id="team1-batted-first-label">Team 1 batted first</label>
                </div>
                <div class="radio-option">
                    <input type="radio" id="team2-batted-first" name="batting-order" value="team2">
                    <label for="team2-batted-first" id="team2-batted-first-label">Team 2 batted first</label>
                </div>
            </div>
            
            <button class="button" onclick="goBack('step3')">‚¨ÖÔ∏è Back</button>
            <button class="button" onclick="proceedToSpecialCase()">Next ‚û°Ô∏è</button>
        </div>

        <div id="step5" class="step-section hidden">
            <div class="step-title">Special Case Check:</div>
            
            <div class="input-group">
                <label id="players-label">Number of players in losing team (default 11):</label>
                <input type="number" id="players" min="1" max="11" value="11">
            </div>
            
            <div id="all-out-section" class="input-group hidden">
                <label id="all-out-question">Did winner get loser all out? (y/n):</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="all-out-yes" name="all-out" value="yes">
                        <label for="all-out-yes">Yes</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="all-out-no" name="all-out" value="no">
                        <label for="all-out-no">No</label>
                    </div>
                </div>
            </div>
            
            <div id="special-case-message" class="special-case hidden">
                ‚ö° Special case: Winner gets maximum bowling points!
            </div>
            
            <button class="button" onclick="goBack('step4')">‚¨ÖÔ∏è Back</button>
            <button class="button" onclick="calculatePoints()">üèÜ Calculate Points</button>
        </div>

        <div class="error" id="error-message"></div>

        <div class="results" id="results">
            <div class="results-header">üèÜ MATCH RESULTS & POINTS BREAKDOWN</div>
            <div id="results-content"></div>
            <button class="button" onclick="resetCalculator()">üîÑ Calculate Another Match</button>
        </div>
    </div>

    <script>
        // Constants from Python class
        const TOTAL_POINTS = 30;
        const BASE_WINNING_POINTS = 20;
        const MAX_BONUS_POINTS = 10;
        const TIE_POINTS = 15;
        const MAX_BOWLING_POINTS = 5;

        // Global variables to store match data
        let matchData = {};
        let currentStep = 1;

        // Initialize the calculator
        function initializeCalculator() {
            document.getElementById('players').addEventListener('input', function() {
                const players = parseInt(this.value);
                const allOutSection = document.getElementById('all-out-section');
                if (players < 8) {
                    allOutSection.classList.remove('hidden');
                } else {
                    allOutSection.classList.add('hidden');
                    document.querySelectorAll('input[name="all-out"]').forEach(radio => {
                        radio.checked = false;
                    });
                    document.getElementById('special-case-message').classList.add('hidden');
                }
            });

            document.querySelectorAll('input[name="all-out"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const specialMessage = document.getElementById('special-case-message');
                    if (this.value === 'yes') {
                        specialMessage.classList.remove('hidden');
                    } else {
                        specialMessage.classList.add('hidden');
                    }
                });
            });
        }

        function showError(message) {
            const errorDiv = document.getElementById('error-message');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }

        function hideAllSteps() {
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`step${i}`).classList.add('hidden');
            }
        }

        function showStep(stepNumber) {
            hideAllSteps();
            document.getElementById(`step${stepNumber}`).classList.remove('hidden');
            currentStep = stepNumber;
        }

        function goBack(targetStep) {
            const stepNumber = parseInt(targetStep.replace('step', ''));
            showStep(stepNumber);
        }

        function proceedToMatchResult() {
            const team1Name = document.getElementById('team1-name').value.trim() || 'Team 1';
            const team2Name = document.getElementById('team2-name').value.trim() || 'Team 2';
            
            matchData.team1_name = team1Name;
            matchData.team2_name = team2Name;
            
            // Update labels
            document.getElementById('team1-wins-label').textContent = `${team1Name} won`;
            document.getElementById('team2-wins-label').textContent = `${team2Name} won`;
            document.getElementById('team1-batted-first-label').textContent = `${team1Name} batted first`;
            document.getElementById('team2-batted-first-label').textContent = `${team2Name} batted first`;
            
            showStep(2);
        }

        function proceedToScores() {
            const selectedResult = document.querySelector('input[name="match-result"]:checked');
            if (!selectedResult) {
                showError('Please select match result');
                return;
            }

            // Handle tie case
            if (selectedResult.value === 'tie') {
                matchData.is_tie = true;
                calculatePoints();
                return;
            }

            matchData.is_tie = false;
            
            // Determine winner and loser
            if (selectedResult.value === 'team1') {
                matchData.winner_name = matchData.team1_name;
                matchData.loser_name = matchData.team2_name;
            } else {
                matchData.winner_name = matchData.team2_name;
                matchData.loser_name = matchData.team1_name;
            }

            // Update labels for step 3
            document.getElementById('winner-announcement').textContent = `üìä ${matchData.winner_name} won! Enter detailed scores:`;
            document.getElementById('winner-runs-label').textContent = `${matchData.winner_name} total runs:`;
            document.getElementById('winner-overs-label').textContent = `${matchData.winner_name} overs faced:`;
            document.getElementById('loser-runs-label').textContent = `${matchData.loser_name} total runs:`;
            document.getElementById('loser-overs-label').textContent = `${matchData.loser_name} overs faced:`;
            document.getElementById('wickets-label').textContent = `Wickets taken by ${matchData.loser_name}:`;

            showStep(3);
        }

        function proceedToBattingOrder() {
            // Validate inputs
            const winnerRuns = document.getElementById('winner-runs').value;
            const winnerOvers = document.getElementById('winner-overs').value;
            const loserRuns = document.getElementById('loser-runs').value;
            const loserOvers = document.getElementById('loser-overs').value;
            const wickets = document.getElementById('wickets').value;

            if (!winnerRuns || !winnerOvers || !loserRuns || !loserOvers || wickets === '') {
                showError('Please fill in all required fields');
                return;
            }

            // Validate overs format (similar to Python logic)
            const winnerOversValue = parseFloat(winnerOvers);
            const loserOversValue = parseFloat(loserOvers);
            
            if (winnerOversValue < 0 || winnerOversValue > 16 || loserOversValue < 0 || loserOversValue > 16) {
                showError('Overs should be between 0 and 16');
                return;
            }

            const wicketsValue = parseInt(wickets);
            if (wicketsValue < 0 || wicketsValue > 10) {
                showError('Wickets should be between 0 and 10');
                return;
            }

            matchData.winner_runs = parseInt(winnerRuns);
            matchData.winner_overs = winnerOversValue;
            matchData.loser_runs = parseInt(loserRuns);
            matchData.loser_overs = loserOversValue;
            matchData.loser_wickets = wicketsValue;

            showStep(4);
        }

        function proceedToSpecialCase() {
            const selectedBattingOrder = document.querySelector('input[name="batting-order"]:checked');
            if (!selectedBattingOrder) {
                showError('Please select who batted first');
                return;
            }

            const firstBatting = selectedBattingOrder.value === 'team1' ? matchData.team1_name : matchData.team2_name;
            matchData.loser_batted_first = (matchData.loser_name === firstBatting);

            // Update labels for step 5
            document.getElementById('players-label').textContent = `Number of players in ${matchData.loser_name} (default 11):`;
            document.getElementById('all-out-question').textContent = `Did ${matchData.winner_name} get ${matchData.loser_name} all out? (y/n):`;

            showStep(5);
        }

        // Core calculation functions (translated from Python)
        function calculateRunRate(runs, overs) {
            return overs === 0 ? 0.0 : runs / overs;
        }

        function calculateBattingPoints(matchData) {
            if (matchData.loser_batted_first) {
                // Batting first: based on run rate comparison
                const winnerRunRate = calculateRunRate(matchData.winner_runs, matchData.winner_overs);
                const loserRunRate = calculateRunRate(matchData.loser_runs, matchData.loser_overs);
                
                if (winnerRunRate === 0) return 0;
                
                const percentage = (loserRunRate / winnerRunRate) * 100;
                
                if (percentage > 90) return 5;
                if (percentage > 80) return 4;
                if (percentage > 70) return 3;
                if (percentage > 60) return 2;
                if (percentage > 50) return 1;
                return 0;
            } else {
                // Batting second: based on percentage of winner's score
                const percentage = (matchData.loser_runs / matchData.winner_runs) * 100;
                
                if (percentage > 90) return 5;
                if (percentage > 80) return 4;
                if (percentage > 70) return 3;
                if (percentage > 60) return 2;
                if (percentage > 50) return 1;
                return 0;
            }
        }

        function calculateBowlingPoints(wickets, specialCase = false) {
            if (specialCase) return MAX_BOWLING_POINTS;
            
            if (wickets >= 7) return 5;
            if (wickets >= 6) return 4;
            if (wickets >= 5) return 3;
            if (wickets >= 3) return 2;
            if (wickets >= 1) return 1;
            return 0;
        }

        function calculatePoints() {
            try {
                // Handle tie case
                if (matchData.is_tie) {
                    displayTieResults();
                    return;
                }

                // Get special case data
                const players = parseInt(document.getElementById('players').value) || 11;
                const allOut = document.querySelector('input[name="all-out"]:checked')?.value === 'yes';
                
                matchData.winner_got_all_out = players < 8 && allOut;

                // Calculate bonus points for losing team
                const battingPoints = calculateBattingPoints(matchData);
                const bowlingPoints = calculateBowlingPoints(matchData.loser_wickets, matchData.winner_got_all_out);
                
                // Total bonus points for loser (max 10)
                const loserBonus = Math.min(battingPoints + bowlingPoints, MAX_BONUS_POINTS);
                
                // Points distribution
                const loserTotalPoints = loserBonus;
                const winnerTotalPoints = BASE_WINNING_POINTS + (MAX_BONUS_POINTS - loserBonus);
                
                // Create results object
                const results = {
                    winner_name: matchData.winner_name,
                    loser_name: matchData.loser_name,
                    winner_points: winnerTotalPoints,
                    loser_points: loserTotalPoints,
                    batting_points: battingPoints,
                    bowling_points: bowlingPoints,
                    loser_bonus: loserBonus,
                    is_tie: false,
                    match_data: matchData
                };

                displayDetailedResults(results);

            } catch (error) {
                showError('Error calculating points. Please check your inputs.');
                console.error(error);
            }
        }

        function displayTieResults() {
            const resultsContent = document.getElementById('results-content');
            
            resultsContent.innerHTML = `
                <div class="console-output">ü§ù TIE MATCH!
üìä ${matchData.team1_name}: ${TIE_POINTS} points
üìä ${matchData.team2_name}: ${TIE_POINTS} points

üí° Tie rule: Both teams get 15 points, no bonus points</div>
                
                <div class="match-summary">
                    <div class="team-result tie">
                        <h3>ü§ù ${matchData.team1_name}</h3>
                        <div class="points-display">${TIE_POINTS}</div>
                        <p>TIE</p>
                    </div>
                    <div class="team-result tie">
                        <h3>ü§ù ${matchData.team2_name}</h3>
                        <div class="points-display">${TIE_POINTS}</div>
                        <p>TIE</p>
                    </div>
                </div>
            `;

            document.getElementById('results').style.display = 'block';
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }

        function displayDetailedResults(results) {
            const matchData = results.match_data;
            
            // Calculate run rates
            const winnerRR = calculateRunRate(matchData.winner_runs, matchData.winner_overs);
            const loserRR = calculateRunRate(matchData.loser_runs, matchData.loser_overs);

            // Calculate percentage for explanation
            let percentage;
            let calculationMethod;
            if (matchData.loser_batted_first) {
                percentage = winnerRR > 0 ? (loserRR / winnerRR) * 100 : 0;
                calculationMethod = `${results.loser_name} batted FIRST\nRun rate percentage: ${percentage.toFixed(1)}% of winner's run rate\nLoser RR: ${loserRR.toFixed(2)}, Winner RR: ${winnerRR.toFixed(2)}`;
            } else {
                percentage = (matchData.loser_runs / matchData.winner_runs) * 100;
                calculationMethod = `${results.loser_name} batted SECOND\nScore percentage: ${percentage.toFixed(1)}% of winner's score\nLoser: ${matchData.loser_runs}, Winner: ${matchData.winner_runs}`;
            }

            const resultsContent = document.getElementById('results-content');
            
            resultsContent.innerHTML = `
                <div class="console-output">üèÜ WINNER: ${results.winner_name} (${results.winner_points} points)
üòî LOSER: ${results.loser_name} (${results.loser_points} points)

üìä MATCH SCORES:
${matchData.winner_name}: ${matchData.winner_runs}/? (${matchData.winner_overs} overs, RR: ${winnerRR.toFixed(2)})
${matchData.loser_name}: ${matchData.loser_runs}/? (${matchData.loser_overs} overs, RR: ${loserRR.toFixed(2)})

üéØ POINTS BREAKDOWN:
Base winning points: ${BASE_WINNING_POINTS}
Maximum bonus points available: ${MAX_BONUS_POINTS}

üèè ${results.loser_name} Bonus Points:
   Batting points: ${results.batting_points}
   Bowling points: ${results.bowling_points}
   Total bonus: ${results.loser_bonus} (max 10)

üèÜ Final Points:
   ${results.winner_name}: ${BASE_WINNING_POINTS} + ${MAX_BONUS_POINTS - results.loser_bonus} = ${results.winner_points}
   ${results.loser_name}: ${results.loser_points}
   Total distributed: ${results.winner_points + results.loser_points}/30

${matchData.winner_got_all_out ? '‚ö° SPECIAL CASE: All out with <8 players - maximum bowling points awarded!\n' : ''}üí° BATTING POINTS CALCULATION (CORRECTED):
   ${calculationMethod}

üé≥ BOWLING POINTS CALCULATION:
   Wickets taken by ${results.loser_name}: ${matchData.loser_wickets}</div>
                
                <div class="match-summary">
                    <div class="team-result winner">
                        <h3>üèÜ ${results.winner_name}</h3>
                        <div class="points-display">${results.winner_points}</div>
                        <p>WINNER</p>
                        <p>${matchData.winner_runs} runs (${matchData.winner_overs} overs)</p>
                        <p>Run Rate: ${winnerRR.toFixed(2)}</p>
                    </div>
                    <div class="team-result loser">
                        <h3>üòî ${results.loser_name}</h3>
                        <div class="points-display">${results.loser_points}</div>
                        <p>BONUS POINTS</p>
                        <p>${matchData.loser_runs} runs (${matchData.loser_overs} overs)</p>
                        <p>Run Rate: ${loserRR.toFixed(2)}</p>
                    </div>
                </div>

                <div class="breakdown">
                    <h3>üéØ Detailed Breakdown</h3>
                    <div class="breakdown-line">
                        <span>Base winning points:</span>
                        <span>${BASE_WINNING_POINTS}</span>
                    </div>
                    <div class="breakdown-line">
                        <span>Maximum bonus available:</span>
                        <span>${MAX_BONUS_POINTS}</span>
                    </div>
                    <div class="breakdown-line">
                        <span><strong>${results.loser_name} Bonus Points:</strong></span>
                        <span></span>
                    </div>
                    <div class="breakdown-line">
                        <span>‚Ä¢ Batting points (${percentage.toFixed(1)}%):</span>
                        <span>${results.batting_points}</span>
                    </div>
                    <div class="breakdown-line">
                        <span>‚Ä¢ Bowling points (${matchData.loser_wickets} wickets${matchData.winner_got_all_out ? ', special case' : ''}):</span>
                        <span>${results.bowling_points}</span>
                    </div>
                    <div class="breakdown-line">
                        <span>‚Ä¢ Total bonus (max 10):</span>
                        <span>${results.loser_bonus}</span>
                    </div>
                    <div class="breakdown-line total">
                        <span><strong>Final Points:</strong></span>
                        <span></span>
                    </div>
                    <div class="breakdown-line">
                        <span>${results.winner_name}: ${BASE_WINNING_POINTS} + (${MAX_BONUS_POINTS} - ${results.loser_bonus})</span>
                        <span>${results.winner_points}</span>
                    </div>
                    <div class="breakdown-line">
                        <span>${results.loser_name}:</span>
                        <span>${results.loser_points}</span>
                    </div>
                    <div class="breakdown-line total">
                        <span>Total Distributed:</span>
                        <span>${results.winner_points + results.loser_points}/30 ‚úì</span>
                    </div>
                </div>
            `;

            document.getElementById('results').style.display = 'block';
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }

        function resetCalculator() {
            // Reset all form fields
            document.querySelectorAll('input').forEach(input => {
                if (input.type === 'text' || input.type === 'number') {
                    input.value = input.id === 'team1-name' ? 'Team 1' : 
                                  input.id === 'team2-name' ? 'Team 2' : 
                                  input.id === 'players' ? '11' : '';
                } else if (input.type === 'radio') {
                    input.checked = false;
                }
            });

            // Reset match data
            matchData = {};
            
            // Hide results and special case message
            document.getElementById('results').style.display = 'none';
            document.getElementById('all-out-section').classList.add('hidden');
            document.getElementById('special-case-message').classList.add('hidden');
            
            // Go back to first step
            showStep(1);
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Initialize the calculator when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeCalculator();
        });
    </script>
</body>
</html>